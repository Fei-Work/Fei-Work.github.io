---
title: "数值分析：解非线性方程组"

categories:
  - blogs
tags:
  - nonlinear equations
  - numerical analysis
  - math
lang: zh
header: 
  teaser: "./assets/images/nonlinear-equations.png"
---

定义以下非线性方程，讨论如何求解，下面进行介绍。


$
f(x) = 0\tag 1
$

## 二分法

二分法顾名思义即每次将函数分为两个区域，逐步逼近最后的根，其基于一个**定理**：

**令$f$是区间$[a,b]$上的连续函数，当满足$f(a)f(b)<0$时，则$f$在$a$与$b$之间存在根**。

典型的二分法计算过程为：

---

取区间$[a,b]$的中点$x_0 = \frac{a+b}{2}$，并计算出$f(x_0)$：

- 若$f(a)f(x_0)=0$，则找到了根
- 若$f(a)f(x_0)>0$，则有根的区间为$[x_0,b]$，即在该区间上进行下一轮迭代
- 若$f(a)f(x_0)<0$，则有根的区间为$[a,x_0]$，即在该区间上进行下一轮迭代

一致循环下去，直到满足条件

---

事实上，计算机计算很难收敛到为0，一般设定为一定的精度$\varepsilon$，当$\vert \alpha-x_n \vert<\varepsilon$时，即认为$x_0为根$

利用该精度，我们也可以提前获知收敛到该精度的迭代次数：

$$
\vert \alpha - x_n \vert \leqslant \frac{b_n-a_n}{2} = \frac{b_0-a_0}{2^{n+1}} \tag2 
$$

$$
n = \frac{(\ln(b_0-a_0)-\ln\varepsilon)}{\ln 2}-1 \tag3
$$

二分法很容易理解，计算过程简单，收敛性也可以保证，但是其缺点也很明显即**收敛速度慢**，**不能求偶数重根**等。

下面介绍一种实际应用中常用的方案：迭代法。



## 迭代法—思想

迭代法的核心思想是**将非线性方程求解转化为一个不动点问题**，即构造一个递推关系式，计算出一个近似序列，并使其收敛于方程(1)的根：

$$
x =G(x)\tag4
$$

同时选定一个根的初始近似值，并进行递推

$$
x_{i+1}=G(x_i), i=0,1,2,\dots \tag 5
$$

这时候，我们不免就开始考虑一个问题，即我们怎么保证我们构造的递推关系式是收敛的？如果得到形如$x_{i+1}=2x_i+1$的递推式，那么显然其永远都不会收敛。为了保证我们构造的递推关系式的收敛性，我们有以下定理：

### 收敛性

$$
\begin{flalign}
& 定理1:\\
& 1-1:若x\in[a,b],G(x)\in[a,b],则认为存在收敛 \\
& 1-2:若\forall x,y\in[a,b], \ G(x)-G(y)<L\vert x-y\vert,\ 0<L<1,则认为存在唯一不动点。
& \end{flalign}
$$

这里简单提一下定理1的证明思路，1-1使用上下限分别相减，即可得到上下限的函数值相反，则存在；1-2是用反证法，假设有两个不动点进行推导，最后会得到只有两者相等1-2才成立

$$
\begin{flalign}
&定理2: \\
&若定理1成立，则x_{k+1}=G(x_k)计算的\{x_k\}收敛到唯一不动点\alpha
&\end{flalign}
$$

定理2的证明比较简单，利用第k个递推式减去不动点后进行推导，可以得到是L的k+1次方乘以常数的一个公式，那么当k趋近于无穷，结果自然就趋近于0。

这种情况我们称为**全局收敛**，事实上，定理一也可以由中值定理写成**导数形式**。即

$$
\begin{flalign}
& \forall x\in[a,b], \ \vert G(x)' \vert<L<1,则认为收敛于唯一根
& \end{flalign}
$$

此外也有**局部收敛**的情况：即在不动点邻域内有收敛，当初值取得很远的时候则可能不能收敛。

### 收敛速度

我们之前提到过二分法收敛速度慢，实际应用中我们一般使用迭代法，关于迭代法的收敛速度，我们可以展开讨论有如下两个定理：

$$
\begin{flalign}
&定理3: \\
&若定理1成立，则\vert \alpha-x_{k+1}\vert \leqslant \frac{L}{1-L} \vert x_{k+1}-x_k \vert
&\end{flalign}
$$

定理3说明了**当L越小的时候，则收敛的速度越快**。

$$
\begin{flalign}
&定理4: \\
&若定理1成立，对于x_{k+1}=G(x_k),若G(x)满足 \\
&(1)G'(\alpha) = G^2(\alpha)=\dots = G^{p-1}(\alpha) = 0 \\
&(2)G^p(\alpha)\neq0 \\
&则认为x_k中p阶收敛于\alpha，反之亦然
&\end{flalign}
$$

证明方法为使得$x_{k+1}$在不动点处执行泰勒展开，可得到如$\lim\limits_{x\rightarrow\infty}\frac{x_{k+1}-\alpha}{(x_k-\alpha)^p}=G^p(\alpha)$，其不等于0。

## 迭代法—简单迭代

即直接构造形如公式(4)的单点定长迭代格式，值得注意的是，我们提到过直接构造的递推关系式事实上不一定收敛，所以首先要利用定理1或由中值定理转化的导数形式判定递推关系式是否收敛。



## 迭代法—牛顿法

上述定理给出了迭代法的迭代性与迭代速度的条件，但是计算过程中核心的步骤之一，**迭代方程的构建**并未提及，下面针对经典方案**牛顿法**的步骤进行讨论，给出牛顿法求解的步骤以及后续的其它变体。

牛顿法通过**泰勒展开**构造迭代式，截取一阶展开：

$$
f(x)\approx x_0+f'(x_0)(x-x_0) \tag 6
$$

联合$(1)$，最终得到：

$$
x_{k+1}=x_k-\frac{f(x_k)}{f'(x_k)} \tag 7
$$

### 收敛性分析

对于$G(x)=x_k-\frac{f(x_k)}{f'(x_k)}$进行求导：

$$
G'(\alpha) = \frac{f(\alpha)f''(\alpha)}{(f'(a))^2} \tag 8
$$

可以注意到当$f'(\alpha) \neq 0$时，由于$f(\alpha)=0$，故$G'(\alpha)=0$，那么其在$\alpha$附近至少是平方收敛的即：**牛顿迭代解（1）的单根问题时至少平方收敛**。但假如为重根，收敛性如何呢？假如为重根，此时可以写成(9)的形式。

$$
f(x)=(x-\alpha)^mg(x) \tag 9
$$

那么：

$$
G(x)=x-\frac{(x-a)^mg(x)}{m(x-a)^{m-1}g'(x)}=x-\frac{(x-a)g(x)}{mg'(x)} \tag {10}
$$

$$
G'(x)=1-\frac1m<1 \tag{11}
$$

即多重根的情况，线性收敛。其实，从式(11)也可以看出，当m=1即单根的情况下，一阶导为0，至少平方收敛。



### 变形

这里举出几个牛顿法变形的例子：

1、简化牛顿法：$x_{k+1}=x_k-\frac{f(x_k)}{c}$，即将原牛顿法来的导数变为一个常数。

2、下山因子法：$x_{k+1}=x_k-\lambda \frac{f(x_k)}{f'(x_k)} $，即综合考虑$x_k$与$x_{k+1}$

3、割线法：$x_{k+1}=x_k- \frac{x_{k+1}-x_k}{f(x_{k+1})-f(x_k)}f(x_k) $，方法如名字，用割线替代导数

这里不再给出其计算效率以及收敛阶。

### 多重根问题

- 当我们得知根的重数$m$时，进行改进：

$$
x_{k+1}=x_k-m\frac{f(x_k)}{f'(x_k)} \tag {12}
$$

此时二阶收敛，这里不进行证明，证明流程略。



- 但其实大部分情况，我们并不知道根的重数，这里的方法为取$u(x)=\frac{f(x)}{f'(x)}$，并修正公式：

$$
x_{k+1}=x_k-\frac{u(x_k)}{u'(x_k)} \tag {13}
$$

该方法实际上需要求原函数$f(x)$的二阶导，计算效率较低，且$u(x)$可能不再是一个连续函数



另外还有一种**Steffensen加速迭代法**可以获取根的重数，再利用式(12)计算收敛值的方法

#### Steffensen加速迭代法

这里列举重要的性质，用于估计跟单重数

$$
\lim\limits_{i\rightarrow\infty} \frac{\varepsilon_{i+1}}{\varepsilon_i}=1-\frac{1}{r} \tag{14}
$$

$$
r\approx \frac{a-x_{i+1}}{x_{i+2}-x_{i+1}}=\frac{x_ix_{i+2}-x_{i+1}^2}{x_{i+2}-2x_{i+1}+x_i}\frac{1}{x_{i+2}-x_{i+1}}-\frac{x_{i+1}}{x_{i+2}-x_{i+1}} \tag{15}
$$



## 非线性方程组情况

若为非线性方程组，即:

$$
F(x)=0,F(x)=(f_1,f_2,\dots,f_n)^T,x=(x_1,x_2,\dots,x_n)^T \tag{16}
$$

使用**拟Newton法**求解，类似于Newton法，求解思路为求出F(x)的Jacobi矩阵，但由于除了需要计算矩阵的Jacobi矩阵并且还要对其求逆，计算量过大，考虑使用一些近似的方法。有：

$$
\left\{
\begin{aligned}
&x^{i+1}  = x^i -H_iF(x^i), \\
&H_{i+1}(F(x^{i+1})-F(x^{i}))  = x^{i+1}-x^i \\
&H_{i+1}  =  H_i+\Delta H_i
\end{aligned}
\right.\tag {17}
$$

其中$H =A^{-1}=F'$

在公式(17)中，我们并未确认$\Delta H_i$的值，取$rank(\Delta H_i)=1$的方法，我们称为**秩1拟Newton法**，这里有Broyden秩1方法与逆Broyden秩1方法，篇幅限制不再过多记录(*是的写到这里已经精疲力尽了，就是写不动了*)。



# 总结

把重要知识点稍微总结如下：

1、收敛性判定

​	--如何判定是否收敛（全局与局部）

​	--如何判断收敛速度（从得到收敛阶与L两个角度）

​	--计算效率的表示方式

2、迭代方法

​	--二分法（方法、收敛速度、缺点）

​	--简单迭代法（收敛性判定）

​	--牛顿法（方法、重根收敛阶问题）

​		----割线法等变形方法

​		----重根问题下的改进牛顿法

​		----了解Steffensen加速迭代

​	--非线性方程组下的秩1拟Newton法







